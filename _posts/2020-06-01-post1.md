---
layout: post
title: python circular import
category: python
---
### 시작 하며

---

복잡한 프로젝트를 다루다 보니 아래와 같은 오류가 발생했다.


<div style="padding-left:2em">

<pre><code class="language-python">import b

  File ".../b.py", line 27, in &lt;module&gt;
    from a import a_class
  File ".../a.py", line 14, in &lt;module&gt;
    from b import b_class
ImportError: cannot import name b_class</code></pre>

</div>

처음 해당 오류를 접했을 때, 단순히 코드상 오타라는 생각을 했지만 해당 문제는 아니였고, <br>
계속 찾아본 결과 circular imnport 관련한 문제라고 한다. 해당 포스팅에서는 해당 현상에 대해 정리 하고자 한다.

&nbsp;
&nbsp;

### Python Circular Imports?

---

- 시작하기 앞써 python 에서 import time, runtime 에 대한 개념정리가 필요하다.
    - runtime 의 경우 실제로 모든 코드가 실행되는 순간
    - import time 의 경우 \*.py 모듈에 들어있는 소스코드를 위에서부터 순서대로 파싱 -> 바이트 코드를 생성 하는 순간
        - 이때 Syntax Error 도 발생하게 되며 \*.pyc 파일도 생성된다.

&nbsp;

- 이제 circular imports 는 뭘까? 한국말로 번역하자면 '순환 참조' 라고도 할 수 있다.
  - 예를 들어 A, B 모듈이 존재할 때, 각각의 모듈에서 서로 상대방을 참조하는 경우를 말한다.

<div style="padding-left:6em">

- a.py 모듈 정의

<pre><code class="language-python">import b

def func_a():
  print('a')
  return b.func_b()

func_a()</code></pre>

- b.py 모듈 정의

<pre><code class="language-python">import a

def func_b():
  print('b')

def func_c():
  print('c')
  return a.func_a()</code></pre>

- 위 모듈 실행 결과

<pre><code>$ python a.py
a
Traceback (most recent call last):
  File "a.py", line 1, in &lt;module&gt;
    import b
  File "/Users/henry-kim/slc/b.py", line 1, in &lt;module&gt;
    import a
  File "/Users/henry-kim/src/a.py", line 8, in &lt;module&gt;
    func_a()
  File "/Users/henry-kim/src/a.py", line 6, in func_a
    return b.func_b()
AttributeError: 'module' object has no attribute 'func_b'

$ python b.py
a
b</code></pre>

- 이 때, a.py 모듈에서 발생하는 이슈를 순환 참조라고 한다.

</div>



&nbsp;
&nbsp;
### 해결책

---


&nbsp;
&nbsp;

### 참고

https://stackabuse.com/python-circular-imports/
https://item4.blog/2017-12-03/Resolve-Circular-Dependency-on-Python-Typing/
https://medium.com/qandastudy/python-circular-imports-e89c5bf16510
